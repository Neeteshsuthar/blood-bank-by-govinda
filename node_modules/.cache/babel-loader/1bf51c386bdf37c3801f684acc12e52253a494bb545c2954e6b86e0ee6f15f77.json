{"ast":null,"code":"import React,{useState}from\"react\";import{Helmet}from\"react-helmet\";import{auth,db}from\"../init-firebase\";import{doc,getDoc,updateDoc}from\"firebase/firestore\";import{updateEmail,updatePassword,reauthenticateWithCredential,EmailAuthProvider}from\"firebase/auth\";import{useNavigate}from\"react-router-dom\";import'../styles/updatepr.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function UpdateProfile(){const[name,setName]=useState(\"\");const[email,setEmail]=useState(\"\");const[password,setPassword]=useState(\"\");const[role,setRole]=useState(\"\");const[currentPassword,setCurrentPassword]=useState(\"\");const navigate=useNavigate();const Submitbtn=async event=>{event.preventDefault();const currentUser=auth.currentUser;if(!currentUser){alert(\"No user is logged in.\");return;}const userId=currentUser.uid;const profileData={Name:name,UserEmail:email,Role:role};try{const userDocRef=doc(db,\"SignuUser\",userId);const userDocSnapshot=await getDoc(userDocRef);if(!userDocSnapshot.exists()){alert(\"User document not found!\");return;}await updateDoc(userDocRef,profileData);alert(\"Profile updated successfully!\");// Update email\nif(email&&email!==currentUser.email){await updateEmail(currentUser,email);alert(\"Email updated successfully!\");}// Update password\nif(password){if(!currentPassword){alert(\"Please enter your current password to update your password.\");return;}const credential=EmailAuthProvider.credential(currentUser.email,currentPassword);await reauthenticateWithCredential(currentUser,credential);await updatePassword(currentUser,password);alert(\"Password updated successfully!\");}navigate(\"/dashboard\");}catch(error){console.error(\"Error updating profile:\",error);alert(error.message||\"Failed to update profile. Please try again.\");}};return/*#__PURE__*/_jsxs(\"div\",{className:\"flex min-h-screen items-center justify-center bg-red-100 blood-background\",children:[/*#__PURE__*/_jsx(Helmet,{children:/*#__PURE__*/_jsx(\"title\",{children:\"Update Profile\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-full max-w-md bg-white rounded-lg shadow-lg p-6 blood-shadow\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-red-600 text-center blood-title\",children:\"Update Profile\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:Submitbtn,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-medium\",htmlFor:\"name\",children:\"Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"name\",className:\"w-full px-4 py-2 mt-2 border border-gray-300 rounded-lg blood-input\",placeholder:\"Enter your name\",value:name,onChange:e=>setName(e.target.value)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-medium\",htmlFor:\"email\",children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",id:\"email\",className:\"w-full px-4 py-2 mt-2 border border-gray-300 rounded-lg blood-input\",placeholder:\"Enter your email\",value:email,onChange:e=>setEmail(e.target.value)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-medium\",htmlFor:\"currentPassword\",children:\"Current Password\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",id:\"currentPassword\",className:\"w-full px-4 py-2 mt-2 border border-gray-300 rounded-lg blood-input\",placeholder:\"Enter your current password\",value:currentPassword,onChange:e=>setCurrentPassword(e.target.value)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-medium\",htmlFor:\"password\",children:\"New Password\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",id:\"password\",className:\"w-full px-4 py-2 mt-2 border border-gray-300 rounded-lg blood-input\",placeholder:\"Enter your new password\",value:password,onChange:e=>setPassword(e.target.value)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-medium\",htmlFor:\"role\",children:\"Role\"}),/*#__PURE__*/_jsxs(\"select\",{id:\"role\",className:\"w-full px-4 py-2 mt-2 border border-gray-300 rounded-lg blood-input\",value:role,onChange:e=>setRole(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"Donor\",children:\"Donor\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Receiver\",children:\"Receiver\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-4\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"w-full bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded-lg blood-button\",children:\"Update Profile\"})})]})]})]});}export default UpdateProfile;","map":{"version":3,"names":["React","useState","Helmet","auth","db","doc","getDoc","updateDoc","updateEmail","updatePassword","reauthenticateWithCredential","EmailAuthProvider","useNavigate","jsx","_jsx","jsxs","_jsxs","UpdateProfile","name","setName","email","setEmail","password","setPassword","role","setRole","currentPassword","setCurrentPassword","navigate","Submitbtn","event","preventDefault","currentUser","alert","userId","uid","profileData","Name","UserEmail","Role","userDocRef","userDocSnapshot","exists","credential","error","console","message","className","children","onSubmit","htmlFor","type","id","placeholder","value","onChange","e","target"],"sources":["C:/Desktop/test project/myapp/src/components/profile.jsx"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport { Helmet } from \"react-helmet\";\r\nimport { auth, db } from \"../init-firebase\";\r\nimport { doc, getDoc, updateDoc } from \"firebase/firestore\";\r\nimport { updateEmail, updatePassword, reauthenticateWithCredential, EmailAuthProvider } from \"firebase/auth\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport '../styles/updatepr.css'\r\nfunction UpdateProfile() {\r\n  const [name, setName] = useState(\"\");\r\n  const [email, setEmail] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [role, setRole] = useState(\"\");\r\n  const [currentPassword, setCurrentPassword] = useState(\"\");\r\n  const navigate = useNavigate();\r\n\r\n  const Submitbtn = async (event) => {\r\n    event.preventDefault();\r\n\r\n    const currentUser = auth.currentUser;\r\n    if (!currentUser) {\r\n      alert(\"No user is logged in.\");\r\n      return;\r\n    }\r\n\r\n    const userId = currentUser.uid;\r\n    const profileData = { Name: name, UserEmail: email, Role: role };\r\n\r\n    try {\r\n      const userDocRef = doc(db, \"SignuUser\", userId);\r\n      const userDocSnapshot = await getDoc(userDocRef);\r\n\r\n      if (!userDocSnapshot.exists()) {\r\n        alert(\"User document not found!\");\r\n        return;\r\n      }\r\n      await updateDoc(userDocRef, profileData);\r\n      alert(\"Profile updated successfully!\");\r\n\r\n      // Update email\r\n      if (email && email !== currentUser.email) {\r\n        await updateEmail(currentUser, email);\r\n        alert(\"Email updated successfully!\");\r\n      }\r\n\r\n      // Update password\r\n      if (password) {\r\n        if (!currentPassword) {\r\n          alert(\"Please enter your current password to update your password.\");\r\n          return;\r\n        }\r\n        const credential = EmailAuthProvider.credential(\r\n          currentUser.email,\r\n          currentPassword\r\n        );\r\n        await reauthenticateWithCredential(currentUser, credential);\r\n        await updatePassword(currentUser, password);\r\n        alert(\"Password updated successfully!\");\r\n      }\r\n\r\n      navigate(\"/dashboard\");\r\n    } catch (error) {\r\n      console.error(\"Error updating profile:\", error);\r\n      alert(error.message || \"Failed to update profile. Please try again.\");\r\n    }\r\n  };\r\n\r\n\r\n  return (\r\n    <div className=\"flex min-h-screen items-center justify-center bg-red-100 blood-background\">\r\n    <Helmet>\r\n      <title>Update Profile</title>\r\n    </Helmet>\r\n    <div className=\"w-full max-w-md bg-white rounded-lg shadow-lg p-6 blood-shadow\">\r\n      <h2 className=\"text-2xl font-bold text-red-600 text-center blood-title\">Update Profile</h2>\r\n      <form onSubmit={Submitbtn}>\r\n        <div className=\"mb-4\">\r\n          <label className=\"block text-gray-700 text-sm font-medium\" htmlFor=\"name\">Name</label>\r\n          <input\r\n            type=\"text\"\r\n            id=\"name\"\r\n            className=\"w-full px-4 py-2 mt-2 border border-gray-300 rounded-lg blood-input\"\r\n            placeholder=\"Enter your name\"\r\n            value={name}\r\n            onChange={(e) => setName(e.target.value)}\r\n          />\r\n        </div>\r\n        <div className=\"mb-4\">\r\n          <label className=\"block text-gray-700 text-sm font-medium\" htmlFor=\"email\">Email</label>\r\n          <input\r\n            type=\"email\"\r\n            id=\"email\"\r\n            className=\"w-full px-4 py-2 mt-2 border border-gray-300 rounded-lg blood-input\"\r\n            placeholder=\"Enter your email\"\r\n            value={email}\r\n            onChange={(e) => setEmail(e.target.value)}\r\n          />\r\n        </div>\r\n        <div className=\"mb-4\">\r\n          <label className=\"block text-gray-700 text-sm font-medium\" htmlFor=\"currentPassword\">Current Password</label>\r\n          <input\r\n            type=\"password\"\r\n            id=\"currentPassword\"\r\n            className=\"w-full px-4 py-2 mt-2 border border-gray-300 rounded-lg blood-input\"\r\n            placeholder=\"Enter your current password\"\r\n            value={currentPassword}\r\n            onChange={(e) => setCurrentPassword(e.target.value)}\r\n          />\r\n        </div>\r\n        <div className=\"mb-4\">\r\n          <label className=\"block text-gray-700 text-sm font-medium\" htmlFor=\"password\">New Password</label>\r\n          <input\r\n            type=\"password\"\r\n            id=\"password\"\r\n            className=\"w-full px-4 py-2 mt-2 border border-gray-300 rounded-lg blood-input\"\r\n            placeholder=\"Enter your new password\"\r\n            value={password}\r\n            onChange={(e) => setPassword(e.target.value)}\r\n          />\r\n        </div>\r\n        <div className=\"mb-4\">\r\n          <label className=\"block text-gray-700 text-sm font-medium\" htmlFor=\"role\">Role</label>\r\n          <select\r\n            id=\"role\"\r\n            className=\"w-full px-4 py-2 mt-2 border border-gray-300 rounded-lg blood-input\"\r\n            value={role}\r\n            onChange={(e) => setRole(e.target.value)}\r\n          >\r\n            <option value=\"Donor\">Donor</option>\r\n            <option value=\"Receiver\">Receiver</option>\r\n          </select>\r\n        </div>\r\n        <div className=\"mb-4\">\r\n          <button\r\n            type=\"submit\"\r\n            className=\"w-full bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded-lg blood-button\"\r\n          >\r\n            Update Profile\r\n          </button>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  </div>\r\n  );\r\n}\r\n\r\nexport default UpdateProfile;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}